exports.handler = async function(event, context) {
    // ===================== SAY HELLO =====================
    // PASTE YOUR BASE64 ENCODED SCRIPT RIGHT HERE ðŸ‘‡
    const base64Script = `LS0gREFTSCAmIEdPRE1PREUgU0NSSVBUIHYxLjAKLS0gQ2xpZW50LXNpZGUgb25seSAtIEV4ZWN1dGUgaW4gTG9jYWxTY3JpcHQKCmlmIG5vdCBnYW1lOklzTG9hZGVkKCkgdGhlbgogICAgZ2FtZS5Mb2FkZWQ6V2FpdCgpCmVuZAoKbG9jYWwgUGxheWVycyA9IGdhbWU6R2V0U2VydmljZSgiUGxheWVycyIpCmxvY2FsIFJ1blNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlJ1blNlcnZpY2UiKQpsb2NhbCBUd2VlblNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlR3ZWVuU2VydmljZSIpCmxvY2FsIFVzZXJJbnB1dFNlcnZpY2UgPSBnYW1lOkdldFNlcnZpY2UoIlVzZXJJbnB1dFNlcnZpY2UiKQpsb2NhbCBXb3Jrc3BhY2UgPSBnYW1lOkdldFNlcnZpY2UoIldvcmtzcGFjZSIpCgpsb2NhbCBMb2NhbFBsYXllciA9IFBsYXllcnMuTG9jYWxQbGF5ZXIKbG9jYWwgUGxheWVyR3VpID0gTG9jYWxQbGF5ZXI6V2FpdEZvckNoaWxkKCJQbGF5ZXJHdWkiKQoKLS0gVmFyaWFibGVzCmxvY2FsIERhc2hIb3RrZXkgPSAiRSIKbG9jYWwgSXNHb2Rtb2RlID0gZmFsc2UKbG9jYWwgSXNTZWxlY3RpbmdLZXkgPSBmYWxzZQpsb2NhbCBJc01vYmlsZURhc2hBY3RpdmUgPSBmYWxzZQpsb2NhbCBEYXNoQ29vbGRvd24gPSBmYWxzZQpsb2NhbCBPcmlnaW5hbE1heEhlYWx0aCA9IDEwMApsb2NhbCBHb2Rtb2RlSGVhbHRoID0gOTk5OTk5OQpsb2NhbCBEYXNoRGlzdGFuY2UgPSAzMApsb2NhbCBEYXNoRHVyYXRpb24gPSAwLjE1CmxvY2FsIENvb2xkb3duVGltZSA9IDIKbG9jYWwgRGFzaFNwZWVkID0gMTAwCmxvY2FsIExvYWRTb3VuZElkID0gMTAyNDgzNjM2MjkwNDYxCmxvY2FsIERhc2hDb25uZWN0aW9uID0gbmlsCmxvY2FsIE1vYmlsZURhc2hHdWkgPSBuaWwKbG9jYWwgR29kbW9kZUd1aSA9IG5pbAoKLS0gUGxheSBsb2FkIHNvdW5kCnNwYXduKGZ1bmN0aW9uKCkKICAgIHdhaXQoMC4xKQogICAgbG9jYWwgbG9hZFNvdW5kID0gSW5zdGFuY2UubmV3KCJTb3VuZCIpCiAgICBsb2FkU291bmQuU291bmRJZCA9ICJyYnhhc3NldGlkOi8vIiAuLiB0b3N0cmluZyhMb2FkU291bmRJZCkKICAgIGxvYWRTb3VuZC5Wb2x1bWUgPSAxCiAgICBsb2FkU291bmQuUGFyZW50ID0gV29ya3NwYWNlCiAgICBsb2FkU291bmQ6UGxheSgpCiAgICBnYW1lOkdldFNlcnZpY2UoIkRlYnJpcyIpOkFkZEl0ZW0obG9hZFNvdW5kLCAzKQplbmQpCgotLSBDbGVhbnVwIGZ1bmN0aW9uCmZ1bmN0aW9uIENsZWFudXBTY3JpcHQoKQogICAgaWYgRGFzaENvbm5lY3Rpb24gdGhlbgogICAgICAgIERhc2hDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgIERhc2hDb25uZWN0aW9uID0gbmlsCiAgICBlbmQKICAgIAogICAgaWYgTW9iaWxlRGFzaEd1aSB0aGVuCiAgICAgICAgTW9iaWxlRGFzaEd1aTpEZXN0cm95KCkKICAgICAgICBNb2JpbGVEYXNoR3VpID0gbmlsCiAgICBlbmQKICAgIAogICAgaWYgR29kbW9kZUd1aSB0aGVuCiAgICAgICAgR29kbW9kZUd1aTpEZXN0cm95KCkKICAgICAgICBHb2Rtb2RlR3VpID0gbmlsCiAgICBlbmQKICAgIAogICAgSXNNb2JpbGVEYXNoQWN0aXZlID0gZmFsc2UKICAgIERhc2hDb29sZG93biA9IGZhbHNlCmVuZAoKLS0gVUkgQ3JlYXRpb24gRnVuY3Rpb25zCmZ1bmN0aW9uIENyZWF0ZVBvcHVwKHRleHQsIGR1cmF0aW9uKQogICAgbG9jYWwgc2NyZWVuR3VpID0gSW5zdGFuY2UubmV3KCJTY3JlZW5HdWkiKQogICAgc2NyZWVuR3VpLk5hbWUgPSAiSW50cm9Qb3B1cCIKICAgIHNjcmVlbkd1aS5SZXNldE9uU3Bhd24gPSBmYWxzZQogICAgc2NyZWVuR3VpLklnbm9yZUd1aUluc2V0ID0gdHJ1ZQogICAgc2NyZWVuR3VpLlpJbmRleEJlaGF2aW9yID0gRW51bS5aSW5kZXhCZWhhdmlvci5HbG9iYWwKICAgIHNjcmVlbkd1aS5QYXJlbnQgPSBQbGF5ZXJHdWkKCiAgICBsb2NhbCBmcmFtZSA9IEluc3RhbmNlLm5ldygiRnJhbWUiKQogICAgZnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAxLCAwKQogICAgZnJhbWUuQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDAsIDApCiAgICBmcmFtZS5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgZnJhbWUuUGFyZW50ID0gc2NyZWVuR3VpCgogICAgbG9jYWwgdGV4dExhYmVsID0gSW5zdGFuY2UubmV3KCJUZXh0TGFiZWwiKQogICAgdGV4dExhYmVsLlNpemUgPSBVRGltMi5uZXcoMCwgNDAwLCAwLCA4MCkKICAgIHRleHRMYWJlbC5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIC0yMDAsIDAuNSwgLTQwKQogICAgdGV4dExhYmVsLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNSwgMjUsIDM1KQogICAgdGV4dExhYmVsLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjgKICAgIHRleHRMYWJlbC5UZXh0ID0gdGV4dAogICAgdGV4dExhYmVsLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQogICAgdGV4dExhYmVsLlRleHRTY2FsZWQgPSB0cnVlCiAgICB0ZXh0TGFiZWwuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkCiAgICB0ZXh0TGFiZWwuVGV4dFN0cm9rZVRyYW5zcGFyZW5jeSA9IDAuNQogICAgdGV4dExhYmVsLlRleHRTdHJva2VDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxNTAsIDAsIDI1NSkKICAgIHRleHRMYWJlbC5WaXNpYmxlID0gZmFsc2UKICAgIHRleHRMYWJlbC5QYXJlbnQgPSBmcmFtZQoKICAgIGxvY2FsIHVpQ29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpCiAgICB1aUNvcm5lci5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLCAxMikKICAgIHVpQ29ybmVyLlBhcmVudCA9IHRleHRMYWJlbAoKICAgIGxvY2FsIHVpU3Ryb2tlID0gSW5zdGFuY2UubmV3KCJVSVN0cm9rZSIpCiAgICB1aVN0cm9rZS5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDE1MCwgMCwgMjU1KQogICAgdWlTdHJva2UuVGhpY2tuZXNzID0gMwogICAgdWlTdHJva2UuUGFyZW50ID0gdGV4dExhYmVsCgogICAgLS0gQW5pbWF0ZSBpbgogICAgdGV4dExhYmVsLlZpc2libGUgPSB0cnVlCiAgICB0ZXh0TGFiZWwuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIHRleHRMYWJlbC5UZXh0VHJhbnNwYXJlbmN5ID0gMQogICAgdWlTdHJva2UuVHJhbnNwYXJlbmN5ID0gMQoKICAgIGxvY2FsIHR3ZWVuSW4gPSBUd2VlblNlcnZpY2U6Q3JlYXRlKHRleHRMYWJlbCwgVHdlZW5JbmZvLm5ldygwLjUsIEVudW0uRWFzaW5nU3R5bGUuUXVhZCwgRW51bS5FYXNpbmdEaXJlY3Rpb24uT3V0KSwgewogICAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjgsCiAgICAgICAgVGV4dFRyYW5zcGFyZW5jeSA9IDAKICAgIH0pCiAgICAKICAgIGxvY2FsIHR3ZWVuU3Ryb2tlID0gVHdlZW5TZXJ2aWNlOkNyZWF0ZSh1aVN0cm9rZSwgVHdlZW5JbmZvLm5ldygwLjUsIEVudW0uRWFzaW5nU3R5bGUuUXVhZCwgRW51bS5FYXNpbmdEaXJlY3Rpb24uT3V0KSwgewogICAgICAgIFRyYW5zcGFyZW5jeSA9IDAKICAgIH0pCgogICAgdHdlZW5JbjpQbGF5KCkKICAgIHR3ZWVuU3Ryb2tlOlBsYXkoKQogICAgdHdlZW5Jbi5Db21wbGV0ZWQ6V2FpdCgpCgogICAgLS0gV2FpdCBkdXJhdGlvbgogICAgd2FpdChkdXJhdGlvbikKCiAgICAtLSBBbmltYXRlIG91dAogICAgbG9jYWwgdHdlZW5PdXQgPSBUd2VlblNlcnZpY2U6Q3JlYXRlKHRleHRMYWJlbCwgVHdlZW5JbmZvLm5ldygwLjUsIEVudW0uRWFzaW5nU3R5bGUuUXVhZCwgRW51bS5FYXNpbmdEaXJlY3Rpb24uSW4pLCB7CiAgICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgICAgVGV4dFRyYW5zcGFyZW5jeSA9IDEKICAgIH0pCiAgICAKICAgIGxvY2FsIHR3ZWVuU3Ryb2tlT3V0ID0gVHdlZW5TZXJ2aWNlOkNyZWF0ZSh1aVN0cm9rZSwgVHdlZW5JbmZvLm5ldygwLjUsIEVudW0uRWFzaW5nU3R5bGUuUXVhZCwgRW51bS5FYXNpbmdEaXJlY3Rpb24uSW4pLCB7CiAgICAgICAgVHJhbnNwYXJlbmN5ID0gMQogICAgfSkKCiAgICB0d2Vlbk91dDpQbGF5KCkKICAgIHR3ZWVuU3Ryb2tlT3V0OlBsYXkoKQogICAgdHdlZW5PdXQuQ29tcGxldGVkOldhaXQoKQoKICAgIHNjcmVlbkd1aTpEZXN0cm95KCkKZW5kCgpmdW5jdGlvbiBDcmVhdGVTZWxlY3RvclVJKCkKICAgIGxvY2FsIHNjcmVlbkd1aSA9IEluc3RhbmNlLm5ldygiU2NyZWVuR3VpIikKICAgIHNjcmVlbkd1aS5OYW1lID0gIkRhc2hTZWxlY3RvciIKICAgIHNjcmVlbkd1aS5SZXNldE9uU3Bhd24gPSBmYWxzZQogICAgc2NyZWVuR3VpLlpJbmRleEJlaGF2aW9yID0gRW51bS5aSW5kZXhCZWhhdmlvci5HbG9iYWwKICAgIHNjcmVlbkd1aS5QYXJlbnQgPSBQbGF5ZXJHdWkKCiAgICBsb2NhbCBtYWluRnJhbWUgPSBJbnN0YW5jZS5uZXcoIkZyYW1lIikKICAgIG1haW5GcmFtZS5TaXplID0gVURpbTIubmV3KDAsIDMwMCwgMCwgMjAwKQogICAgbWFpbkZyYW1lLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgLTE1MCwgMC41LCAtMTAwKQogICAgbWFpbkZyYW1lLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigzMCwgMjAsIDQwKQogICAgbWFpbkZyYW1lLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjEKICAgIG1haW5GcmFtZS5QYXJlbnQgPSBzY3JlZW5HdWkKCiAgICBsb2NhbCB1aUNvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQogICAgdWlDb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgMTIpCiAgICB1aUNvcm5lci5QYXJlbnQgPSBtYWluRnJhbWUKCiAgICBsb2NhbCB1aVN0cm9rZSA9IEluc3RhbmNlLm5ldygiVUlTdHJva2UiKQogICAgdWlTdHJva2UuQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDAsIDIwMCkKICAgIHVpU3Ryb2tlLlRoaWNrbmVzcyA9IDIKICAgIHVpU3Ryb2tlLlBhcmVudCA9IG1haW5GcmFtZQoKICAgIGxvY2FsIHRpdGxlTGFiZWwgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCiAgICB0aXRsZUxhYmVsLlNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgNDApCiAgICB0aXRsZUxhYmVsLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDAsIDEwKQogICAgdGl0bGVMYWJlbC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgdGl0bGVMYWJlbC5UZXh0ID0gIkRBU0ggU0NSSVBUIgogICAgdGl0bGVMYWJlbC5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKICAgIHRpdGxlTGFiZWwuVGV4dFNjYWxlZCA9IHRydWUKICAgIHRpdGxlTGFiZWwuRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkCiAgICB0aXRsZUxhYmVsLlBhcmVudCA9IG1haW5GcmFtZQoKICAgIC0tIFBDIEJ1dHRvbgogICAgbG9jYWwgcGNCdXR0b24gPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iKQogICAgcGNCdXR0b24uU2l6ZSA9IFVEaW0yLm5ldygwLjgsIDAsIDAsIDQwKQogICAgcGNCdXR0b24uUG9zaXRpb24gPSBVRGltMi5uZXcoMC4xLCAwLCAwLjQsIDApCiAgICBwY0J1dHRvbi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTAwLCAwLCAyMDApCiAgICBwY0J1dHRvbi5UZXh0ID0gIlBDIgogICAgcGNCdXR0b24uVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpCiAgICBwY0J1dHRvbi5Gb250ID0gRW51bS5Gb250LkdvdGhhbVNlbWlib2xkCiAgICBwY0J1dHRvbi5UZXh0U2l6ZSA9IDE4CiAgICBwY0J1dHRvbi5QYXJlbnQgPSBtYWluRnJhbWUKCiAgICBsb2NhbCBwY0Nvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQogICAgcGNDb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgOCkKICAgIHBjQ29ybmVyLlBhcmVudCA9IHBjQnV0dG9uCgogICAgbG9jYWwgcGNTdHJva2UgPSBJbnN0YW5jZS5uZXcoIlVJU3Ryb2tlIikKICAgIHBjU3Ryb2tlLkNvbG9yID0gQ29sb3IzLmZyb21SR0IoMTUwLCA1MCwgMjU1KQogICAgcGNTdHJva2UuVGhpY2tuZXNzID0gMgogICAgcGNTdHJva2UuUGFyZW50ID0gcGNCdXR0b24KCiAgICAtLSBNb2JpbGUgQnV0dG9uCiAgICBsb2NhbCBtb2JpbGVCdXR0b24gPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iKQogICAgbW9iaWxlQnV0dG9uLlNpemUgPSBVRGltMi5uZXcoMC44LCAwLCAwLCA0MCkKICAgIG1vYmlsZUJ1dHRvbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjEsIDAsIDAuNjUsIDApCiAgICBtb2JpbGVCdXR0b24uQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDEwMCwgMCwgMjAwKQogICAgbW9iaWxlQnV0dG9uLlRleHQgPSAiTU9CSUxFIgogICAgbW9iaWxlQnV0dG9uLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQogICAgbW9iaWxlQnV0dG9uLkZvbnQgPSBFbnVtLkZvbnQuR290aGFtU2VtaWJvbGQKICAgIG1vYmlsZUJ1dHRvbi5UZXh0U2l6ZSA9IDE4CiAgICBtb2JpbGVCdXR0b24uUGFyZW50ID0gbWFpbkZyYW1lCgogICAgbG9jYWwgbW9iaWxlQ29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpCiAgICBtb2JpbGVDb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgOCkKICAgIG1vYmlsZUNvcm5lci5QYXJlbnQgPSBtb2JpbGVCdXR0b24KCiAgICBsb2NhbCBtb2JpbGVTdHJva2UgPSBJbnN0YW5jZS5uZXcoIlVJU3Ryb2tlIikKICAgIG1vYmlsZVN0cm9rZS5Db2xvciA9IENvbG9yMy5mcm9tUkdCKDE1MCwgNTAsIDI1NSkKICAgIG1vYmlsZVN0cm9rZS5UaGlja25lc3MgPSAyCiAgICBtb2JpbGVTdHJva2UuUGFyZW50ID0gbW9iaWxlQnV0dG9uCgogICAgLS0gQnV0dG9uIGFuaW1hdGlvbnMKICAgIGxvY2FsIGZ1bmN0aW9uIHNldHVwQnV0dG9uSG92ZXIoYnV0dG9uKQogICAgICAgIGxvY2FsIG9yaWdpbmFsU2l6ZSA9IGJ1dHRvbi5TaXplCiAgICAgICAgbG9jYWwgb3JpZ2luYWxDb2xvciA9IGJ1dHRvbi5CYWNrZ3JvdW5kQ29sb3IzCiAgICAgICAgCiAgICAgICAgYnV0dG9uLk1vdXNlRW50ZXI6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgIFR3ZWVuU2VydmljZTpDcmVhdGUoYnV0dG9uLCBUd2VlbkluZm8ubmV3KDAuMiksIHsKICAgICAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMzAsIDMwLCAyMzApCiAgICAgICAgICAgIH0pOlBsYXkoKQogICAgICAgIGVuZCkKICAgICAgICAKICAgICAgICBidXR0b24uTW91c2VMZWF2ZTpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShidXR0b24sIFR3ZWVuSW5mby5uZXcoMC4yKSwgewogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yMyA9IG9yaWdpbmFsQ29sb3IKICAgICAgICAgICAgfSk6UGxheSgpCiAgICAgICAgZW5kKQogICAgICAgIAogICAgICAgIGJ1dHRvbi5Nb3VzZUJ1dHRvbjFEb3duOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKGJ1dHRvbiwgVHdlZW5JbmZvLm5ldygwLjEpLCB7CiAgICAgICAgICAgICAgICBTaXplID0gb3JpZ2luYWxTaXplIC0gVURpbTIubmV3KDAsIDUsIDAsIDUpCiAgICAgICAgICAgIH0pOlBsYXkoKQogICAgICAgIGVuZCkKICAgICAgICAKICAgICAgICBidXR0b24uTW91c2VCdXR0b24xVXA6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgICAgIFR3ZWVuU2VydmljZTpDcmVhdGUoYnV0dG9uLCBUd2VlbkluZm8ubmV3KDAuMSksIHsKICAgICAgICAgICAgICAgIFNpemUgPSBvcmlnaW5hbFNpemUKICAgICAgICAgICAgfSk6UGxheSgpCiAgICAgICAgZW5kKQogICAgZW5kCgogICAgc2V0dXBCdXR0b25Ib3ZlcihwY0J1dHRvbikKICAgIHNldHVwQnV0dG9uSG92ZXIobW9iaWxlQnV0dG9uKQoKICAgIC0tIEJ1dHRvbiBmdW5jdGlvbnMKICAgIHBjQnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIHNjcmVlbkd1aTpEZXN0cm95KCkKICAgICAgICBDcmVhdGVLZXlTZWxlY3RvcigpCiAgICBlbmQpCgogICAgbW9iaWxlQnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIHNjcmVlbkd1aTpEZXN0cm95KCkKICAgICAgICBDcmVhdGVNb2JpbGVEYXNoQnV0dG9uKCkKICAgIGVuZCkKCiAgICByZXR1cm4gc2NyZWVuR3VpCmVuZAoKZnVuY3Rpb24gQ3JlYXRlS2V5U2VsZWN0b3IoKQogICAgbG9jYWwgc2NyZWVuR3VpID0gSW5zdGFuY2UubmV3KCJTY3JlZW5HdWkiKQogICAgc2NyZWVuR3VpLk5hbWUgPSAiS2V5U2VsZWN0b3IiCiAgICBzY3JlZW5HdWkuUmVzZXRPblNwYXduID0gZmFsc2UKICAgIHNjcmVlbkd1aS5aSW5kZXhCZWhhdmlvciA9IEVudW0uWkluZGV4QmVoYXZpb3IuR2xvYmFsCiAgICBzY3JlZW5HdWkuUGFyZW50ID0gUGxheWVyR3VpCgogICAgbG9jYWwgbWFpbkZyYW1lID0gSW5zdGFuY2UubmV3KCJGcmFtZSIpCiAgICBtYWluRnJhbWUuU2l6ZSA9IFVEaW0yLm5ldygwLCAyNTAsIDAsIDE1MCkKICAgIG1haW5GcmFtZS5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIC0xMjUsIDAuNSwgLTc1KQogICAgbWFpbkZyYW1lLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigzMCwgMjAsIDQwKQogICAgbWFpbkZyYW1lLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjEKICAgIG1haW5GcmFtZS5QYXJlbnQgPSBzY3JlZW5HdWkKCiAgICBsb2NhbCB1aUNvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQogICAgdWlDb3JuZXIuQ29ybmVyUmFkaXVzID0gVURpbS5uZXcoMCwgMTIpCiAgICB1aUNvcm5lci5QYXJlbnQgPSBtYWluRnJhbWUKCiAgICBsb2NhbCB1aVN0cm9rZSA9IEluc3RhbmNlLm5ldygiVUlTdHJva2UiKQogICAgdWlTdHJva2UuQ29sb3IgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDAsIDIwMCkKICAgIHVpU3Ryb2tlLlRoaWNrbmVzcyA9IDIKICAgIHVpU3Ryb2tlLlBhcmVudCA9IG1haW5GcmFtZQoKICAgIGxvY2FsIHRpdGxlTGFiZWwgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCiAgICB0aXRsZUxhYmVsLlNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMzApCiAgICB0aXRsZUxhYmVsLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDAsIDEwKQogICAgdGl0bGVMYWJlbC5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgdGl0bGVMYWJlbC5UZXh0ID0gIlBSRVNTIEFOWSBLRVkiCiAgICB0aXRsZUxhYmVsLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQogICAgdGl0bGVMYWJlbC5UZXh0U2NhbGVkID0gdHJ1ZQogICAgdGl0bGVMYWJlbC5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQKICAgIHRpdGxlTGFiZWwuUGFyZW50ID0gbWFpbkZyYW1lCgogICAgbG9jYWwga2V5TGFiZWwgPSBJbnN0YW5jZS5uZXcoIlRleHRMYWJlbCIpCiAgICBrZXlMYWJlbC5TaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDQwKQogICAga2V5TGFiZWwuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMC4zLCAwKQogICAga2V5TGFiZWwuQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIGtleUxhYmVsLlRleHQgPSAiQ3VycmVudDogIiAuLiBEYXNoSG90a2V5CiAgICBrZXlMYWJlbC5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjAwLCAxMDAsIDI1NSkKICAgIGtleUxhYmVsLlRleHRTY2FsZWQgPSB0cnVlCiAgICBrZXlMYWJlbC5Gb250ID0gRW51bS5Gb250LkdvdGhhbVNlbWlib2xkCiAgICBrZXlMYWJlbC5QYXJlbnQgPSBtYWluRnJhbWUKCiAgICBsb2NhbCBkb25lQnV0dG9uID0gSW5zdGFuY2UubmV3KCJUZXh0QnV0dG9uIikKICAgIGRvbmVCdXR0b24uU2l6ZSA9IFVEaW0yLm5ldygwLjYsIDAsIDAsIDM1KQogICAgZG9uZUJ1dHRvbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjIsIDAsIDAuNywgMCkKICAgIGRvbmVCdXR0b24uQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDEwMCwgMCwgMjAwKQogICAgZG9uZUJ1dHRvbi5UZXh0ID0gIkRPTkUiCiAgICBkb25lQnV0dG9uLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQogICAgZG9uZUJ1dHRvbi5Gb250ID0gRW51bS5Gb250LkdvdGhhbVNlbWlib2xkCiAgICBkb25lQnV0dG9uLlRleHRTaXplID0gMTYKICAgIGRvbmVCdXR0b24uUGFyZW50ID0gbWFpbkZyYW1lCgogICAgbG9jYWwgZG9uZUNvcm5lciA9IEluc3RhbmNlLm5ldygiVUlDb3JuZXIiKQogICAgZG9uZUNvcm5lci5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLCA4KQogICAgZG9uZUNvcm5lci5QYXJlbnQgPSBkb25lQnV0dG9uCgogICAgZG9uZUJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBzY3JlZW5HdWk6RGVzdHJveSgpCiAgICAgICAgU2V0dXBEYXNoTGlzdGVuZXIoKQogICAgZW5kKQoKICAgIElzU2VsZWN0aW5nS2V5ID0gdHJ1ZQogICAgCiAgICBsb2NhbCBrZXlDb25uZWN0aW9uCiAgICBrZXlDb25uZWN0aW9uID0gVXNlcklucHV0U2VydmljZS5JbnB1dEJlZ2FuOkNvbm5lY3QoZnVuY3Rpb24oaW5wdXQsIGdhbWVQcm9jZXNzZWQpCiAgICAgICAgaWYgZ2FtZVByb2Nlc3NlZCBvciBub3QgSXNTZWxlY3RpbmdLZXkgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgCiAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuS2V5Ym9hcmQgdGhlbgogICAgICAgICAgICBEYXNoSG90a2V5ID0gaW5wdXQuS2V5Q29kZS5OYW1lCiAgICAgICAgICAgIGtleUxhYmVsLlRleHQgPSAiQ3VycmVudDogIiAuLiBEYXNoSG90a2V5CiAgICAgICAgICAgIAogICAgICAgICAgICAtLSBBbmltYXRlIGtleSBjaGFuZ2UKICAgICAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShrZXlMYWJlbCwgVHdlZW5JbmZvLm5ldygwLjIpLCB7CiAgICAgICAgICAgICAgICBUZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKICAgICAgICAgICAgfSk6UGxheSgpCiAgICAgICAgICAgIAogICAgICAgICAgICB3YWl0KDAuMikKICAgICAgICAgICAgCiAgICAgICAgICAgIFR3ZWVuU2VydmljZTpDcmVhdGUoa2V5TGFiZWwsIFR3ZWVuSW5mby5uZXcoMC4yKSwgewogICAgICAgICAgICAgICAgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDIwMCwgMTAwLCAyNTUpCiAgICAgICAgICAgIH0pOlBsYXkoKQogICAgICAgIGVuZAogICAgZW5kKQogICAgCiAgICAtLSBDbGVhbnVwIHdoZW4gR1VJIGlzIGRlc3Ryb3llZAogICAgc2NyZWVuR3VpLkRlc3Ryb3lpbmc6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgSXNTZWxlY3RpbmdLZXkgPSBmYWxzZQogICAgICAgIGlmIGtleUNvbm5lY3Rpb24gdGhlbgogICAgICAgICAgICBrZXlDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgIGVuZAogICAgZW5kKQplbmQKCi0tIEZJWEVEIE1PQklMRSBEQVNIIEJVVFRPTgpmdW5jdGlvbiBDcmVhdGVNb2JpbGVEYXNoQnV0dG9uKCkKICAgIElzTW9iaWxlRGFzaEFjdGl2ZSA9IHRydWUKICAgIAogICAgLS0gQ2xlYW4gdXAgb2xkIG1vYmlsZSBkYXNoIEdVSSBpZiBleGlzdHMKICAgIGlmIE1vYmlsZURhc2hHdWkgdGhlbgogICAgICAgIE1vYmlsZURhc2hHdWk6RGVzdHJveSgpCiAgICBlbmQKICAgIAogICAgTW9iaWxlRGFzaEd1aSA9IEluc3RhbmNlLm5ldygiU2NyZWVuR3VpIikKICAgIE1vYmlsZURhc2hHdWkuTmFtZSA9ICJNb2JpbGVEYXNoIgogICAgTW9iaWxlRGFzaEd1aS5SZXNldE9uU3Bhd24gPSBmYWxzZQogICAgTW9iaWxlRGFzaEd1aS5aSW5kZXhCZWhhdmlvciA9IEVudW0uWkluZGV4QmVoYXZpb3IuR2xvYmFsCiAgICBNb2JpbGVEYXNoR3VpLlBhcmVudCA9IFBsYXllckd1aQoKICAgIGxvY2FsIGRhc2hCdXR0b24gPSBJbnN0YW5jZS5uZXcoIlRleHRCdXR0b24iKQogICAgZGFzaEJ1dHRvbi5TaXplID0gVURpbTIubmV3KDAsIDEwMCwgMCwgMTAwKQogICAgZGFzaEJ1dHRvbi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLjgsIC01MCwgMC43LCAtNTApCiAgICBkYXNoQnV0dG9uLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDAsIDIwMCkKICAgIGRhc2hCdXR0b24uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuMgogICAgZGFzaEJ1dHRvbi5UZXh0ID0gIkRBU0giCiAgICBkYXNoQnV0dG9uLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KQogICAgZGFzaEJ1dHRvbi5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQKICAgIGRhc2hCdXR0b24uVGV4dFNpemUgPSAyMAogICAgZGFzaEJ1dHRvbi5UZXh0U2NhbGVkID0gdHJ1ZQogICAgZGFzaEJ1dHRvbi5QYXJlbnQgPSBNb2JpbGVEYXNoR3VpCgogICAgbG9jYWwgdWlDb3JuZXIgPSBJbnN0YW5jZS5uZXcoIlVJQ29ybmVyIikKICAgIHVpQ29ybmVyLkNvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDEsIDApCiAgICB1aUNvcm5lci5QYXJlbnQgPSBkYXNoQnV0dG9uCgogICAgbG9jYWwgdWlTdHJva2UgPSBJbnN0YW5jZS5uZXcoIlVJU3Ryb2tlIikKICAgIHVpU3Ryb2tlLkNvbG9yID0gQ29sb3IzLmZyb21SR0IoMTUwLCA1MCwgMjU1KQogICAgdWlTdHJva2UuVGhpY2tuZXNzID0gMwogICAgdWlTdHJva2UuUGFyZW50ID0gZGFzaEJ1dHRvbgoKICAgIC0tIEZJWEVEOiBCdXR0b24gYWN0aXZhdGlvbgogICAgbG9jYWwgZnVuY3Rpb24gb25EYXNoQnV0dG9uQ2xpY2tlZCgpCiAgICAgICAgaWYgbm90IERhc2hDb29sZG93biB0aGVuCiAgICAgICAgICAgIFBlcmZvcm1EYXNoKCkKICAgICAgICBlbmQKICAgIGVuZAoKICAgIC0tIE1vYmlsZSB0b3VjaCBpbnB1dAogICAgZGFzaEJ1dHRvbi5Nb3VzZUJ1dHRvbjFEb3duOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIC0tIEJ1dHRvbiBwcmVzcyBhbmltYXRpb24KICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKGRhc2hCdXR0b24sIFR3ZWVuSW5mby5uZXcoMC4xKSwgewogICAgICAgICAgICBTaXplID0gVURpbTIubmV3KDAsIDkwLCAwLCA5MCksCiAgICAgICAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjEKICAgICAgICB9KTpQbGF5KCkKICAgIGVuZCkKICAgIAogICAgZGFzaEJ1dHRvbi5Nb3VzZUJ1dHRvbjFVcDpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICAtLSBCdXR0b24gcmVsZWFzZSBhbmltYXRpb24KICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKGRhc2hCdXR0b24sIFR3ZWVuSW5mby5uZXcoMC4xKSwgewogICAgICAgICAgICBTaXplID0gVURpbTIubmV3KDAsIDEwMCwgMCwgMTAwKSwKICAgICAgICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuMgogICAgICAgIH0pOlBsYXkoKQogICAgICAgIAogICAgICAgIG9uRGFzaEJ1dHRvbkNsaWNrZWQoKQogICAgZW5kKQogICAgCiAgICBkYXNoQnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3Qob25EYXNoQnV0dG9uQ2xpY2tlZCkKICAgIAogICAgLS0gRHJhZ2dhYmxlIGZ1bmN0aW9uYWxpdHkKICAgIGxvY2FsIGRyYWdnaW5nID0gZmFsc2UKICAgIGxvY2FsIGRyYWdTdGFydCA9IG5pbAogICAgbG9jYWwgc3RhcnRQb3MgPSBuaWwKCiAgICBkYXNoQnV0dG9uLklucHV0QmVnYW46Q29ubmVjdChmdW5jdGlvbihpbnB1dCkKICAgICAgICBpZiBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgIGRyYWdnaW5nID0gdHJ1ZQogICAgICAgICAgICBkcmFnU3RhcnQgPSBpbnB1dC5Qb3NpdGlvbgogICAgICAgICAgICBzdGFydFBvcyA9IGRhc2hCdXR0b24uUG9zaXRpb24KICAgICAgICAgICAgCiAgICAgICAgICAgIFR3ZWVuU2VydmljZTpDcmVhdGUoZGFzaEJ1dHRvbiwgVHdlZW5JbmZvLm5ldygwLjEpLCB7CiAgICAgICAgICAgICAgICBTaXplID0gVURpbTIubmV3KDAsIDkwLCAwLCA5MCksCiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC4xCiAgICAgICAgICAgIH0pOlBsYXkoKQogICAgICAgIGVuZAogICAgZW5kKQoKICAgIGRhc2hCdXR0b24uSW5wdXRFbmRlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIGlucHV0LlVzZXJJbnB1dFR5cGUgPT0gRW51bS5Vc2VySW5wdXRUeXBlLlRvdWNoIHRoZW4KICAgICAgICAgICAgZHJhZ2dpbmcgPSBmYWxzZQogICAgICAgICAgICAKICAgICAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShkYXNoQnV0dG9uLCBUd2VlbkluZm8ubmV3KDAuMSksIHsKICAgICAgICAgICAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgMTAwLCAwLCAxMDApLAogICAgICAgICAgICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuMgogICAgICAgICAgICB9KTpQbGF5KCkKICAgICAgICAgICAgCiAgICAgICAgICAgIC0tIE9ubHkgdHJpZ2dlciBkYXNoIGlmIGl0IHdhcyBhIHRhcCAobWluaW1hbCBtb3ZlbWVudCkKICAgICAgICAgICAgaWYgZHJhZ1N0YXJ0IGFuZCAoaW5wdXQuUG9zaXRpb24gLSBkcmFnU3RhcnQpLk1hZ25pdHVkZSA8IDIwIHRoZW4KICAgICAgICAgICAgICAgIG9uRGFzaEJ1dHRvbkNsaWNrZWQoKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZCkKCiAgICBsb2NhbCBkcmFnQ29ubmVjdGlvbgogICAgZHJhZ0Nvbm5lY3Rpb24gPSBVc2VySW5wdXRTZXJ2aWNlLklucHV0Q2hhbmdlZDpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICAgIGlmIGRyYWdnaW5nIGFuZCBpbnB1dC5Vc2VySW5wdXRUeXBlID09IEVudW0uVXNlcklucHV0VHlwZS5Ub3VjaCB0aGVuCiAgICAgICAgICAgIGxvY2FsIGRlbHRhID0gaW5wdXQuUG9zaXRpb24gLSBkcmFnU3RhcnQKICAgICAgICAgICAgZGFzaEJ1dHRvbi5Qb3NpdGlvbiA9IHN0YXJ0UG9zICsgVURpbTIubmV3KDAsIGRlbHRhLlgsIDAsIGRlbHRhLlkpCiAgICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIC0tIENsZWFudXAKICAgIE1vYmlsZURhc2hHdWkuRGVzdHJveWluZzpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBJc01vYmlsZURhc2hBY3RpdmUgPSBmYWxzZQogICAgICAgIGlmIGRyYWdDb25uZWN0aW9uIHRoZW4KICAgICAgICAgICAgZHJhZ0Nvbm5lY3Rpb246RGlzY29ubmVjdCgpCiAgICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIHJldHVybiBNb2JpbGVEYXNoR3VpCmVuZAoKZnVuY3Rpb24gQ3JlYXRlR29kbW9kZUJ1dHRvbigpCiAgICAtLSBDbGVhbiB1cCBvbGQgZ29kbW9kZSBHVUkgaWYgZXhpc3RzCiAgICBpZiBHb2Rtb2RlR3VpIHRoZW4KICAgICAgICBHb2Rtb2RlR3VpOkRlc3Ryb3koKQogICAgZW5kCiAgICAKICAgIEdvZG1vZGVHdWkgPSBJbnN0YW5jZS5uZXcoIlNjcmVlbkd1aSIpCiAgICBHb2Rtb2RlR3VpLk5hbWUgPSAiR29kbW9kZVVJIgogICAgR29kbW9kZUd1aS5SZXNldE9uU3Bhd24gPSBmYWxzZQogICAgR29kbW9kZUd1aS5aSW5kZXhCZWhhdmlvciA9IEVudW0uWkluZGV4QmVoYXZpb3IuR2xvYmFsCiAgICBHb2Rtb2RlR3VpLlBhcmVudCA9IFBsYXllckd1aQoKICAgIGxvY2FsIGdvZEJ1dHRvbiA9IEluc3RhbmNlLm5ldygiVGV4dEJ1dHRvbiIpCiAgICBnb2RCdXR0b24uU2l6ZSA9IFVEaW0yLm5ldygwLCAxNjAsIDAsIDQ1KQogICAgZ29kQnV0dG9uLlBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgLTgwLCAwLjA1LCAwKQogICAgZ29kQnV0dG9uLkJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDAsIDIwMCkKICAgIGdvZEJ1dHRvbi5UZXh0ID0gIkdPRE1PREU6IE9GRiIKICAgIGdvZEJ1dHRvbi5UZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKICAgIGdvZEJ1dHRvbi5Gb250ID0gRW51bS5Gb250LkdvdGhhbUJvbGQKICAgIGdvZEJ1dHRvbi5UZXh0U2l6ZSA9IDE2CiAgICBnb2RCdXR0b24uUGFyZW50ID0gR29kbW9kZUd1aQoKICAgIGxvY2FsIHVpQ29ybmVyID0gSW5zdGFuY2UubmV3KCJVSUNvcm5lciIpCiAgICB1aUNvcm5lci5Db3JuZXJSYWRpdXMgPSBVRGltLm5ldygwLCA4KQogICAgdWlDb3JuZXIuUGFyZW50ID0gZ29kQnV0dG9uCgogICAgbG9jYWwgdWlTdHJva2UgPSBJbnN0YW5jZS5uZXcoIlVJU3Ryb2tlIikKICAgIHVpU3Ryb2tlLkNvbG9yID0gQ29sb3IzLmZyb21SR0IoMjU1LCAyNTUsIDI1NSkKICAgIHVpU3Ryb2tlLlRoaWNrbmVzcyA9IDIKICAgIHVpU3Ryb2tlLlBhcmVudCA9IGdvZEJ1dHRvbgoKICAgIC0tIFJhaW5ib3cgZ3JhZGllbnQgZm9yIHN0cm9rZQogICAgbG9jYWwgZ3JhZGllbnQgPSBJbnN0YW5jZS5uZXcoIlVJR3JhZGllbnQiKQogICAgZ3JhZGllbnQuQ29sb3IgPSBDb2xvclNlcXVlbmNlLm5ldyh7CiAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLCBDb2xvcjMuZnJvbVJHQigyNTUsIDAsIDApKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAuMTcsIENvbG9yMy5mcm9tUkdCKDI1NSwgMTY1LCAwKSksCiAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLjMzLCBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMCkpLAogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMC41LCBDb2xvcjMuZnJvbVJHQigwLCAyNTUsIDApKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAuNjcsIENvbG9yMy5mcm9tUkdCKDAsIDAsIDI1NSkpLAogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMC44MywgQ29sb3IzLmZyb21SR0IoNzUsIDAsIDEzMCkpLAogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMSwgQ29sb3IzLmZyb21SR0IoMjM4LCAxMzAsIDIzOCkpCiAgICB9KQogICAgZ3JhZGllbnQuUm90YXRpb24gPSA0NQogICAgZ3JhZGllbnQuUGFyZW50ID0gdWlTdHJva2UKCiAgICAtLSBBbmltYXRlIGdyYWRpZW50CiAgICBsb2NhbCBncmFkaWVudEFuaW1hdGlvbgogICAgZ3JhZGllbnRBbmltYXRpb24gPSBSdW5TZXJ2aWNlLlJlbmRlclN0ZXBwZWQ6Q29ubmVjdChmdW5jdGlvbihkZWx0YSkKICAgICAgICBncmFkaWVudC5PZmZzZXQgPSBWZWN0b3IyLm5ldyhtYXRoLmNvcyh0aWNrKCkgKiAyKSAqIDAuNSwgbWF0aC5zaW4odGljaygpICogMikgKiAwLjUpCiAgICBlbmQpCgogICAgLS0gSG92ZXIgYW5pbWF0aW9ucwogICAgZ29kQnV0dG9uLk1vdXNlRW50ZXI6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShnb2RCdXR0b24sIFR3ZWVuSW5mby5uZXcoMC4yKSwgewogICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTMwLCAzMCwgMjMwKQogICAgICAgIH0pOlBsYXkoKQogICAgZW5kKQogICAgCiAgICBnb2RCdXR0b24uTW91c2VMZWF2ZTpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKGdvZEJ1dHRvbiwgVHdlZW5JbmZvLm5ldygwLjIpLCB7CiAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDAsIDIwMCkKICAgICAgICB9KTpQbGF5KCkKICAgIGVuZCkKCiAgICBnb2RCdXR0b24uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgSXNHb2Rtb2RlID0gbm90IElzR29kbW9kZQogICAgICAgIAogICAgICAgIGlmIElzR29kbW9kZSB0aGVuCiAgICAgICAgICAgIGdvZEJ1dHRvbi5UZXh0ID0gIkdPRE1PREU6IE9OIgogICAgICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKGdvZEJ1dHRvbiwgVHdlZW5JbmZvLm5ldygwLjIpLCB7CiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMCwgMjAwLCAwKQogICAgICAgICAgICB9KTpQbGF5KCkKICAgICAgICAgICAgQWN0aXZhdGVHb2Rtb2RlKCkKICAgICAgICBlbHNlCiAgICAgICAgICAgIGdvZEJ1dHRvbi5UZXh0ID0gIkdPRE1PREU6IE9GRiIKICAgICAgICAgICAgVHdlZW5TZXJ2aWNlOkNyZWF0ZShnb2RCdXR0b24sIFR3ZWVuSW5mby5uZXcoMC4yKSwgewogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDEwMCwgMCwgMjAwKQogICAgICAgICAgICB9KTpQbGF5KCkKICAgICAgICAgICAgRGVhY3RpdmF0ZUdvZG1vZGUoKQogICAgICAgIGVuZAogICAgZW5kKQogICAgCiAgICAtLSBDbGVhbnVwCiAgICBHb2Rtb2RlR3VpLkRlc3Ryb3lpbmc6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgaWYgZ3JhZGllbnRBbmltYXRpb24gdGhlbgogICAgICAgICAgICBncmFkaWVudEFuaW1hdGlvbjpEaXNjb25uZWN0KCkKICAgICAgICBlbmQKICAgIGVuZCkKICAgIAogICAgcmV0dXJuIEdvZG1vZGVHdWkKZW5kCgotLSBXQUxMLVBIQVNJTkcgREFTSCBGVU5DVElPTkFMSVRZCmZ1bmN0aW9uIFBlcmZvcm1EYXNoKCkKICAgIGlmIERhc2hDb29sZG93biB0aGVuIHJldHVybiBlbmQKICAgIAogICAgbG9jYWwgY2hhcmFjdGVyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICBpZiBub3QgY2hhcmFjdGVyIHRoZW4gcmV0dXJuIGVuZAogICAgCiAgICBsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKQogICAgbG9jYWwgaHVtYW5vaWRSb290UGFydCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWRSb290UGFydCIpCiAgICAKICAgIGlmIG5vdCBodW1hbm9pZCBvciBub3QgaHVtYW5vaWRSb290UGFydCB0aGVuIHJldHVybiBlbmQKICAgIAogICAgaWYgaHVtYW5vaWQuSGVhbHRoIDw9IDAgb3IgaHVtYW5vaWQ6R2V0U3RhdGUoKSA9PSBFbnVtLkh1bWFub2lkU3RhdGVUeXBlLkRlYWQgdGhlbgogICAgICAgIHJldHVybgogICAgZW5kCiAgICAKICAgIERhc2hDb29sZG93biA9IHRydWUKICAgIAogICAgLS0gU3RvcmUgb3JpZ2luYWwgcHJvcGVydGllcyBmb3Igd2FsbCBwaGFzaW5nCiAgICBsb2NhbCBvcmlnaW5hbENhbkNvbGxpZGUgPSB7fQogICAgbG9jYWwgb3JpZ2luYWxUcmFuc3BhcmVuY3kgPSB7fQogICAgCiAgICAtLSBNYWtlIGNoYXJhY3RlciBwYXJ0cyBub24tY29sbGlkYWJsZSBhbmQgdHJhbnNwYXJlbnQgdGVtcG9yYXJpbHkKICAgIGZvciBfLCBwYXJ0IGluIHBhaXJzKGNoYXJhY3RlcjpHZXREZXNjZW5kYW50cygpKSBkbwogICAgICAgIGlmIHBhcnQ6SXNBKCJCYXNlUGFydCIpIHRoZW4KICAgICAgICAgICAgb3JpZ2luYWxDYW5Db2xsaWRlW3BhcnRdID0gcGFydC5DYW5Db2xsaWRlCiAgICAgICAgICAgIG9yaWdpbmFsVHJhbnNwYXJlbmN5W3BhcnRdID0gcGFydC5UcmFuc3BhcmVuY3kKICAgICAgICAgICAgcGFydC5DYW5Db2xsaWRlID0gZmFsc2UKICAgICAgICAgICAgcGFydC5UcmFuc3BhcmVuY3kgPSAwLjcKICAgICAgICBlbmQKICAgIGVuZAogICAgCiAgICAtLSBHZXQgZGFzaCBkaXJlY3Rpb24KICAgIGxvY2FsIGRhc2hEaXJlY3Rpb24gPSBodW1hbm9pZFJvb3RQYXJ0LkNGcmFtZS5Mb29rVmVjdG9yCiAgICBsb2NhbCBzdGFydFBvc2l0aW9uID0gaHVtYW5vaWRSb290UGFydC5Qb3NpdGlvbgogICAgbG9jYWwgdGFyZ2V0UG9zaXRpb24gPSBzdGFydFBvc2l0aW9uICsgKGRhc2hEaXJlY3Rpb24gKiBEYXNoRGlzdGFuY2UpCiAgICAKICAgIC0tIFVzZSBCb2R5VmVsb2NpdHkgZm9yIHZpc2libGUgbW92ZW1lbnQKICAgIGxvY2FsIGJvZHlWZWxvY2l0eSA9IEluc3RhbmNlLm5ldygiQm9keVZlbG9jaXR5IikKICAgIGJvZHlWZWxvY2l0eS5WZWxvY2l0eSA9IGRhc2hEaXJlY3Rpb24gKiBEYXNoU3BlZWQKICAgIGJvZHlWZWxvY2l0eS5NYXhGb3JjZSA9IFZlY3RvcjMubmV3KDEwMDAwLCAxMDAwMCwgMTAwMDApCiAgICBib2R5VmVsb2NpdHkuUCA9IDEwMDAwCiAgICBib2R5VmVsb2NpdHkuUGFyZW50ID0gaHVtYW5vaWRSb290UGFydAogICAgCiAgICAtLSBDb29sZG93biBpbmRpY2F0b3IgZm9yIG1vYmlsZSBidXR0b24KICAgIGlmIElzTW9iaWxlRGFzaEFjdGl2ZSBhbmQgTW9iaWxlRGFzaEd1aSB0aGVuCiAgICAgICAgbG9jYWwgZGFzaEJ1dHRvbiA9IE1vYmlsZURhc2hHdWk6RmluZEZpcnN0Q2hpbGQoIlRleHRCdXR0b24iKQogICAgICAgIGlmIGRhc2hCdXR0b24gdGhlbgogICAgICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKGRhc2hCdXR0b24sIFR3ZWVuSW5mby5uZXcoMC4yKSwgewogICAgICAgICAgICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDUwLCAwLCAxMDApCiAgICAgICAgICAgIH0pOlBsYXkoKQogICAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIC0tIENyZWF0ZSBhIHNpbXBsZSBwdXJwbGUgZmxhc2ggZWZmZWN0CiAgICBzcGF3bihmdW5jdGlvbigpCiAgICAgICAgZm9yIF8sIHBhcnQgaW4gcGFpcnMoY2hhcmFjdGVyOkdldERlc2NlbmRhbnRzKCkpIGRvCiAgICAgICAgICAgIGlmIHBhcnQ6SXNBKCJCYXNlUGFydCIpIHRoZW4KICAgICAgICAgICAgICAgIGxvY2FsIG9yaWdpbmFsQ29sb3IgPSBwYXJ0LkNvbG9yCiAgICAgICAgICAgICAgICBwYXJ0LkNvbG9yID0gQ29sb3IzLmZyb21SR0IoMTUwLCA1MCwgMjU1KQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBzcGF3bihmdW5jdGlvbigpCiAgICAgICAgICAgICAgICAgICAgd2FpdCgwLjEpCiAgICAgICAgICAgICAgICAgICAgcGFydC5Db2xvciA9IG9yaWdpbmFsQ29sb3IKICAgICAgICAgICAgICAgIGVuZCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIC0tIFdhaXQgZm9yIGRhc2ggZHVyYXRpb24KICAgIHdhaXQoRGFzaER1cmF0aW9uKQogICAgCiAgICAtLSBSZW1vdmUgdmVsb2NpdHkKICAgIGlmIGJvZHlWZWxvY2l0eSBhbmQgYm9keVZlbG9jaXR5LlBhcmVudCB0aGVuCiAgICAgICAgYm9keVZlbG9jaXR5OkRlc3Ryb3koKQogICAgZW5kCiAgICAKICAgIC0tIFJlc3RvcmUgb3JpZ2luYWwgcHJvcGVydGllcwogICAgZm9yIHBhcnQsIGNhbkNvbGxpZGUgaW4gcGFpcnMob3JpZ2luYWxDYW5Db2xsaWRlKSBkbwogICAgICAgIGlmIHBhcnQgYW5kIHBhcnQuUGFyZW50IHRoZW4KICAgICAgICAgICAgcGFydC5DYW5Db2xsaWRlID0gY2FuQ29sbGlkZQogICAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIGZvciBwYXJ0LCB0cmFuc3BhcmVuY3kgaW4gcGFpcnMob3JpZ2luYWxUcmFuc3BhcmVuY3kpIGRvCiAgICAgICAgaWYgcGFydCBhbmQgcGFydC5QYXJlbnQgdGhlbgogICAgICAgICAgICBwYXJ0LlRyYW5zcGFyZW5jeSA9IHRyYW5zcGFyZW5jeQogICAgICAgIGVuZAogICAgZW5kCiAgICAKICAgIC0tIFJlc2V0IGNvb2xkb3duCiAgICBzcGF3bihmdW5jdGlvbigpCiAgICAgICAgd2FpdChDb29sZG93blRpbWUgLSBEYXNoRHVyYXRpb24pCiAgICAgICAgRGFzaENvb2xkb3duID0gZmFsc2UKICAgICAgICAKICAgICAgICAtLSBSZXNldCBidXR0b24gY29sb3IgZm9yIG1vYmlsZQogICAgICAgIGlmIElzTW9iaWxlRGFzaEFjdGl2ZSBhbmQgTW9iaWxlRGFzaEd1aSB0aGVuCiAgICAgICAgICAgIGxvY2FsIGRhc2hCdXR0b24gPSBNb2JpbGVEYXNoR3VpOkZpbmRGaXJzdENoaWxkKCJUZXh0QnV0dG9uIikKICAgICAgICAgICAgaWYgZGFzaEJ1dHRvbiB0aGVuCiAgICAgICAgICAgICAgICBUd2VlblNlcnZpY2U6Q3JlYXRlKGRhc2hCdXR0b24sIFR3ZWVuSW5mby5uZXcoMC4yKSwgewogICAgICAgICAgICAgICAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxMDAsIDAsIDIwMCkKICAgICAgICAgICAgICAgIH0pOlBsYXkoKQogICAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgIGVuZCkKZW5kCgotLSBGSVhFRDogRGFzaCBsaXN0ZW5lciB0aGF0IHJlY29ubmVjdHMgb24gcmVzcGF3bgpmdW5jdGlvbiBTZXR1cERhc2hMaXN0ZW5lcigpCiAgICAtLSBEaXNjb25uZWN0IG9sZCBsaXN0ZW5lciBpZiBleGlzdHMKICAgIGlmIERhc2hDb25uZWN0aW9uIHRoZW4KICAgICAgICBEYXNoQ29ubmVjdGlvbjpEaXNjb25uZWN0KCkKICAgIGVuZAogICAgCiAgICAtLSBDcmVhdGUgbmV3IGxpc3RlbmVyCiAgICBEYXNoQ29ubmVjdGlvbiA9IFVzZXJJbnB1dFNlcnZpY2UuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0LCBnYW1lUHJvY2Vzc2VkKQogICAgICAgIGlmIGdhbWVQcm9jZXNzZWQgb3IgSXNTZWxlY3RpbmdLZXkgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgCiAgICAgICAgaWYgaW5wdXQuVXNlcklucHV0VHlwZSA9PSBFbnVtLlVzZXJJbnB1dFR5cGUuS2V5Ym9hcmQgYW5kIGlucHV0LktleUNvZGUuTmFtZSA9PSBEYXNoSG90a2V5IHRoZW4KICAgICAgICAgICAgUGVyZm9ybURhc2goKQogICAgICAgIGVuZAogICAgZW5kKQplbmQKCi0tIEdvZG1vZGUgZnVuY3Rpb25hbGl0eQpsb2NhbCBHb2Rtb2RlQ29ubmVjdGlvbiA9IG5pbApsb2NhbCBPcmlnaW5hbEhlYWx0aCA9IDEwMAoKZnVuY3Rpb24gQWN0aXZhdGVHb2Rtb2RlKCkKICAgIGxvY2FsIGNoYXJhY3RlciA9IExvY2FsUGxheWVyLkNoYXJhY3RlcgogICAgaWYgbm90IGNoYXJhY3RlciB0aGVuIHJldHVybiBlbmQKICAgIAogICAgbG9jYWwgaHVtYW5vaWQgPSBjaGFyYWN0ZXI6V2FpdEZvckNoaWxkKCJIdW1hbm9pZCIsIDUpCiAgICBpZiBub3QgaHVtYW5vaWQgdGhlbiByZXR1cm4gZW5kCiAgICAKICAgIC0tIFNhdmUgb3JpZ2luYWwgaGVhbHRoCiAgICBPcmlnaW5hbEhlYWx0aCA9IGh1bWFub2lkLkhlYWx0aAogICAgT3JpZ2luYWxNYXhIZWFsdGggPSBodW1hbm9pZC5NYXhIZWFsdGgKICAgIAogICAgLS0gU2V0IGdvZG1vZGUgaGVhbHRoCiAgICBodW1hbm9pZC5NYXhIZWFsdGggPSBHb2Rtb2RlSGVhbHRoCiAgICBodW1hbm9pZC5IZWFsdGggPSBHb2Rtb2RlSGVhbHRoCiAgICAKICAgIC0tIEZvcmNlIGFsaXZlIHN0YXRlCiAgICBpZiBodW1hbm9pZDpHZXRTdGF0ZSgpID09IEVudW0uSHVtYW5vaWRTdGF0ZVR5cGUuRGVhZCB0aGVuCiAgICAgICAgaHVtYW5vaWQ6Q2hhbmdlU3RhdGUoRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5SdW5uaW5nKQogICAgZW5kCiAgICAKICAgIC0tIENvbnRpbnVvdXMgaGVhbHRoIGNvcnJlY3Rpb24KICAgIGlmIEdvZG1vZGVDb25uZWN0aW9uIHRoZW4KICAgICAgICBHb2Rtb2RlQ29ubmVjdGlvbjpEaXNjb25uZWN0KCkKICAgIGVuZAogICAgCiAgICBHb2Rtb2RlQ29ubmVjdGlvbiA9IFJ1blNlcnZpY2UuSGVhcnRiZWF0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGlmIG5vdCBJc0dvZG1vZGUgdGhlbgogICAgICAgICAgICBHb2Rtb2RlQ29ubmVjdGlvbjpEaXNjb25uZWN0KCkKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgbG9jYWwgY3VycmVudENoYXIgPSBMb2NhbFBsYXllci5DaGFyYWN0ZXIKICAgICAgICBpZiBub3QgY3VycmVudENoYXIgdGhlbiByZXR1cm4gZW5kCiAgICAgICAgCiAgICAgICAgbG9jYWwgY3VycmVudEh1bSA9IGN1cnJlbnRDaGFyOkZpbmRGaXJzdENoaWxkKCJIdW1hbm9pZCIpCiAgICAgICAgaWYgbm90IGN1cnJlbnRIdW0gdGhlbiByZXR1cm4gZW5kCiAgICAgICAgCiAgICAgICAgLS0gRm9yY2UgaGVhbHRoIHRvIG1heAogICAgICAgIGN1cnJlbnRIdW0uTWF4SGVhbHRoID0gR29kbW9kZUhlYWx0aAogICAgICAgIGN1cnJlbnRIdW0uSGVhbHRoID0gR29kbW9kZUhlYWx0aAogICAgICAgIAogICAgICAgIC0tIFByZXZlbnQgZGVhdGggc3RhdGUKICAgICAgICBpZiBjdXJyZW50SHVtOkdldFN0YXRlKCkgPT0gRW51bS5IdW1hbm9pZFN0YXRlVHlwZS5EZWFkIHRoZW4KICAgICAgICAgICAgY3VycmVudEh1bTpDaGFuZ2VTdGF0ZShFbnVtLkh1bWFub2lkU3RhdGVUeXBlLlJ1bm5pbmcpCiAgICAgICAgZW5kCiAgICAgICAgCiAgICAgICAgLS0gUmVtb3ZlIGFueSBuZWdhdGl2ZSBoZWFsdGggZWZmZWN0cwogICAgICAgIGZvciBfLCB2IGluIHBhaXJzKGN1cnJlbnRDaGFyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICAgIGlmIHY6SXNBKCJGb3JjZUZpZWxkIikgdGhlbgogICAgICAgICAgICAgICAgdjpEZXN0cm95KCkKICAgICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICBlbmQpCmVuZAoKZnVuY3Rpb24gRGVhY3RpdmF0ZUdvZG1vZGUoKQogICAgSXNHb2Rtb2RlID0gZmFsc2UKICAgIAogICAgaWYgR29kbW9kZUNvbm5lY3Rpb24gdGhlbgogICAgICAgIEdvZG1vZGVDb25uZWN0aW9uOkRpc2Nvbm5lY3QoKQogICAgICAgIEdvZG1vZGVDb25uZWN0aW9uID0gbmlsCiAgICBlbmQKICAgIAogICAgbG9jYWwgY2hhcmFjdGVyID0gTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyCiAgICBpZiBub3QgY2hhcmFjdGVyIHRoZW4gcmV0dXJuIGVuZAogICAgCiAgICBsb2NhbCBodW1hbm9pZCA9IGNoYXJhY3RlcjpGaW5kRmlyc3RDaGlsZCgiSHVtYW5vaWQiKQogICAgaWYgbm90IGh1bWFub2lkIHRoZW4gcmV0dXJuIGVuZAogICAgCiAgICAtLSBSZXN0b3JlIG9yaWdpbmFsIGhlYWx0aAogICAgaHVtYW5vaWQuTWF4SGVhbHRoID0gT3JpZ2luYWxNYXhIZWFsdGgKICAgIGh1bWFub2lkLkhlYWx0aCA9IG1hdGgubWluKE9yaWdpbmFsSGVhbHRoLCBPcmlnaW5hbE1heEhlYWx0aCkKZW5kCgotLSBJbml0aWFsaXplIGV2ZXJ5dGhpbmcKZnVuY3Rpb24gSW5pdGlhbGl6ZVNjcmlwdCgpCiAgICAtLSBQbGF5IGludHJvIHBvcHVwCiAgICBDcmVhdGVQb3B1cCgiTE9BREVEIDB4MHgwIERBU0ggU0NSSVBUIiwgMikKICAgIAogICAgd2FpdCgwLjUpCiAgICAKICAgIC0tIENyZWF0ZSBVSSBlbGVtZW50cwogICAgQ3JlYXRlU2VsZWN0b3JVSSgpCiAgICBDcmVhdGVHb2Rtb2RlQnV0dG9uKCkKICAgIAogICAgLS0gU2V0dXAgZGFzaCBsaXN0ZW5lciBmb3IgUEMKICAgIGlmIG5vdCBJc01vYmlsZURhc2hBY3RpdmUgdGhlbgogICAgICAgIFNldHVwRGFzaExpc3RlbmVyKCkKICAgIGVuZAogICAgCiAgICBwcmludCgiRGFzaCAmIEdvZG1vZGUgU2NyaXB0IExvYWRlZCBTdWNjZXNzZnVsbHkhIikKICAgIHByaW50KCJEYXNoIEtleTogIiAuLiBEYXNoSG90a2V5KQogICAgcHJpbnQoIkNvb2xkb3duOiAiIC4uIENvb2xkb3duVGltZSAuLiAiIHNlY29uZHMiKQogICAgcHJpbnQoIldhbGwgUGhhc2luZzogRU5BQkxFRCIpCiAgICBwcmludCgiUmVzcGF3biBTdXBwb3J0OiBFTkFCTEVEIikKZW5kCgotLSBIYW5kbGUgcmVzcGF3bmluZwpMb2NhbFBsYXllci5DaGFyYWN0ZXJBZGRlZDpDb25uZWN0KGZ1bmN0aW9uKGNoYXJhY3RlcikKICAgIHdhaXQoMSkgLS0gV2FpdCBmb3IgY2hhcmFjdGVyIHRvIGZ1bGx5IGxvYWQKICAgIAogICAgcHJpbnQoIkNoYXJhY3RlciByZXNwYXduZWQgLSByZWluaXRpYWxpemluZyBkYXNoIHN5c3RlbS4uLiIpCiAgICAKICAgIC0tIFJlc2V0IGRhc2ggY29vbGRvd24KICAgIERhc2hDb29sZG93biA9IGZhbHNlCiAgICAKICAgIC0tIFJlYXBwbHkgZ29kbW9kZSBpZiBpdCB3YXMgYWN0aXZlCiAgICBpZiBJc0dvZG1vZGUgdGhlbgogICAgICAgIHdhaXQoMC41KQogICAgICAgIGxvY2FsIGh1bWFub2lkID0gY2hhcmFjdGVyOldhaXRGb3JDaGlsZCgiSHVtYW5vaWQiLCA1KQogICAgICAgIGlmIGh1bWFub2lkIHRoZW4KICAgICAgICAgICAgaHVtYW5vaWQuTWF4SGVhbHRoID0gR29kbW9kZUhlYWx0aAogICAgICAgICAgICBodW1hbm9pZC5IZWFsdGggPSBHb2Rtb2RlSGVhbHRoCiAgICAgICAgICAgIAogICAgICAgICAgICAtLSBSZWFjdGl2YXRlIGdvZG1vZGUgc3lzdGVtCiAgICAgICAgICAgIEFjdGl2YXRlR29kbW9kZSgpCiAgICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgLS0gUmUtc2V0dXAgZGFzaCBsaXN0ZW5lciBmb3IgUEMKICAgIGlmIG5vdCBJc01vYmlsZURhc2hBY3RpdmUgdGhlbgogICAgICAgIFNldHVwRGFzaExpc3RlbmVyKCkKICAgIGVuZAogICAgCiAgICAtLSBSZXNldCBtb2JpbGUgYnV0dG9uIGNvbG9yIGlmIGFjdGl2ZQogICAgaWYgSXNNb2JpbGVEYXNoQWN0aXZlIGFuZCBNb2JpbGVEYXNoR3VpIHRoZW4KICAgICAgICBsb2NhbCBkYXNoQnV0dG9uID0gTW9iaWxlRGFzaEd1aTpGaW5kRmlyc3RDaGlsZCgiVGV4dEJ1dHRvbiIpCiAgICAgICAgaWYgZGFzaEJ1dHRvbiB0aGVuCiAgICAgICAgICAgIFR3ZWVuU2VydmljZTpDcmVhdGUoZGFzaEJ1dHRvbiwgVHdlZW5JbmZvLm5ldygwLjIpLCB7CiAgICAgICAgICAgICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTAwLCAwLCAyMDApCiAgICAgICAgICAgIH0pOlBsYXkoKQogICAgICAgIGVuZAogICAgZW5kCmVuZCkKCi0tIENsZWFudXAgb24gY2hhcmFjdGVyIHJlbW92YWwKTG9jYWxQbGF5ZXIuQ2hhcmFjdGVyUmVtb3Zpbmc6Q29ubmVjdChmdW5jdGlvbigpCiAgICBEYXNoQ29vbGRvd24gPSBmYWxzZQogICAgcHJpbnQoIkNoYXJhY3RlciByZW1vdmVkIC0gcmVzZXR0aW5nIGRhc2ggY29vbGRvd24uLi4iKQplbmQpCgotLSBDbGVhbnVwIG9uIHBsYXllciBsZWF2aW5nCkxvY2FsUGxheWVyLlBsYXllckd1aS5DaGlsZFJlbW92ZWQ6Q29ubmVjdChmdW5jdGlvbihjaGlsZCkKICAgIGlmIGNoaWxkLk5hbWUgPT0gIk1vYmlsZURhc2giIG9yIGNoaWxkLk5hbWUgPT0gIkdvZG1vZGVVSSIgdGhlbgogICAgICAgIENsZWFudXBTY3JpcHQoKQogICAgZW5kCmVuZCkKCi0tIFN0YXJ0IHRoZSBzY3JpcHQKSW5pdGlhbGl6ZVNjcmlwdCgp`.trim();
    // ===================== SAY HELLO =====================
    
    const loaderScript = `--[[ 0x0x0 DASH LOADER ]]
-- This loader decodes and runs the actual script

if not game then
    print("ERROR: This script must be executed in Roblox!")
    return
end

print("Loading 0x0x0 DASH...")

-- Decode Base64
local encoded = "${base64Script.replace(/\n/g, '')}"
local decoded = ""
local b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"

-- Remove any whitespace
encoded = encoded:gsub("%s+", "")

-- Base64 decode
for i=1, #encoded, 4 do
    local n1 = b:find(encoded:sub(i,i)) or 0
    local n2 = b:find(encoded:sub(i+1,i+1)) or 0
    local n3 = b:find(encoded:sub(i+2,i+2)) or 0
    local n4 = b:find(encoded:sub(i+3,i+3)) or 0
    
    if n1 > 0 then n1 = n1 - 1 end
    if n2 > 0 then n2 = n2 - 1 end
    if n3 > 0 then n3 = n3 - 1 end
    if n4 > 0 then n4 = n4 - 1 end
    
    local byte1 = bit32.lshift(n1, 2) + bit32.rshift(n2, 4)
    local byte2 = bit32.lshift(bit32.band(n2, 15), 4) + bit32.rshift(n3, 2)
    local byte3 = bit32.lshift(bit32.band(n3, 3), 6) + n4
    
    decoded = decoded .. string.char(byte1)
    if n3 > 0 then decoded = decoded .. string.char(byte2) end
    if n4 > 0 then decoded = decoded .. string.char(byte3) end
end

-- Execute the actual script
loadstring(decoded)()
print("0x0x0 DASH loaded successfully!")`;
    
    return {
        statusCode: 200,
        headers: {
            'Content-Type': 'text/plain',
            'Cache-Control': 'no-cache'
        },
        body: loaderScript
    };
};
